<h2>Задание 1: Создание Dockerfile для приложения веб-сервера</h2>
Вам необходимо написать Dockerfile для создания контейнера с приложением
веб-сервера на основе образа Ubuntu 20.04. Приложение должно быть
запущено на порту 8080 и должно отдавать статические файлы из каталога
/app/static.

Шаги, которые необходимо выполнить:
<ol>
<li>Создайте новый файл Dockerfile в пустой директории на вашем
локальном компьютере.</li>
<li>Напишите инструкцию FROM, которая указывает базовый образ
Ubuntu 20.04.</li>
<li>Установите необходимые зависимости с помощью инструкции RUN.</li>
Установите пакеты nginx и curl, а также создайте каталог /app/static.
<li>Скопируйте файл конфигурации nginx из вашего локального каталога
внутрь контейнера с помощью инструкции COPY.</li>
<li>Скопируйте статические файлы из каталога /app/static на вашем
локальном компьютере внутрь контейнера с помощью инструкции COPY.</li>
<li>Используйте инструкцию EXPOSE для открытия порта 8080.</li>
<li>Используйте инструкцию CMD для запуска команды nginx с указанием
пути к файлу конфигурации, который вы скопировали на шаге 4.</li>
<li>Сохраните файл Dockerfile и соберите образ с помощью команды docker
build.</li>
<li>Запустите контейнер из образа с помощью команды docker run и
проверьте, что веб-сервер отдает статические файлы из каталога /app/static на
порту 8080</li>
</ol>

Создаю локальную папку и перехожу в нее:

    mkdir docker
    cd docker/

Создаю Dockerfile:

    vim Dockerfile
***
    FROM ubuntu:20.04
    RUN apt-get -y update && apt-get -y install nginx curl
    RUN rm -f /etc/nginx/sites-enabled/default
    WORKDIR /app/static
    COPY static.conf /etc/nginx/conf.d/default.conf
    COPY index.html .
    EXPOSE 8080/tcp
    CMD ["nginx", "-g", "daemon off;"]

>[!NOTE]
>До RUN rm -f /etc/nginx/sites-enabled/default дошел опытным путем.
>Получал дефолтную страницу, понял, что беда в дефолтном файле.
>Сходил на контейнер, удалил файл, убедился, что получаю свой html

Создаю nginx.conf:

    vim static.conf
***
    server {
      listen 80;
      server_name 0.0.0.0;
      
      root /app/static/;
      index index.html;
    
      location / {
        try_files $uri $uri/ =404;
      }
    }
Копирую html из 15 домашки:

    sudo cp /var/www/lesson_15_hw/index.html ~/docker/index.html

Собираю образ и запускаю контейнер:

    docker build . -t my-static
    docker run -d -it --name my-static -p 8080:80 my-static:latest 
Курлю:

    curl 127.0.0.1:8080
***
    <!DOCTYPE html>
    <html>
        <head>
    	<meta charset="UTF-8">
            <title>lesson_15_hw-WebServers</title>
        </head>
        <body>
            <h1>WebServers</h1>
            <h2>Ходырев Иван</h2>
            <p>Веб-сервер — сервер, принимающий HTTP-запросы от клиентов, обычно веб-браузеров, и выдающий им HTTP-ответы, как правило, вместе с HTML-страницей, изображением, файлом, медиа-потоком или другими данными.</p>
    	<p>Веб-сервером называют как программное обеспечение, выполняющее функции веб-сервера, так и непосредственно компьютер (см.: Сервер (аппаратное обеспечение)), на котором это программное обеспечение работает.</p>
    	<p>Клиент, которым обычно является веб-браузер, передаёт веб-серверу запросы на получение ресурсов, обозначенных URL-адресами. Ресурсы — это HTML-страницы, изображения, файлы, медиа-потоки или другие данные, которые необходимы клиенту. В ответ веб-сервер передаёт клиенту запрошенные данные. Этот обмен происходит по протоколу HTTP.</p>
        </body>
    </html>

<h2>Задание 2 – развертывание приложения с помощью Docker-compose</h2>

Шаги, которые необходимо выполнить:
<ol>
<li>Создайте новый файл docker-compose.yml в пустой директории на
вашем локальном компьютере.</li>
<li>Напишите инструкцию version в версии 3.</li>
<li>Определите сервис для базы данных PostgreSQL. Назовите его "db".
Используйте образ postgres:latest, задайте переменные окружения
POSTGRES_USER, POSTGRES_PASSWORD и POSTGRES_DB для
установки пользовательского имени, пароля и имени базы данных
соответственно.</li>
<li>Определите сервис для веб-сервера на основе образа NGINX. Назовите
его "web". Используйте образ nginx:latest. Определите порт, на котором
должен работать сервер, с помощью инструкции ports. Задайте путь к
файлам конфигурации NGINX внутри контейнера, используя
инструкцию volumes.</li>
<li>Определите ссылку на сервис базы данных в сервисе веб-сервера.
Используйте инструкцию links.</li>
<li>Сохраните файл docker-compose.yml и запустите приложение с
помощью команды docker-compose up.</li>
<li>Проверьте, что приложение работает, перейдя в браузере на
localhost:80</li>
</ol>
